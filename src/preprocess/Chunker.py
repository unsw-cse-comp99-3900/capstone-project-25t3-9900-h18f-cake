import sys, os, json, re
import re
from typing import List, Dict
from nltk.tokenize import TextTilingTokenizer

sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))
# from preprocess.Clean import TextCleaner
# from preprocess.Loader import DataLoader
# from preprocess.Segment import Segmenter
'''
output format:
{'para_id': 9, 'chunk_index': 121, 'chunk_text': '***'}, 
'''
class Chunker:
    def __init__(self,max_chars_len,#每个 chunk 最大字符数
                 use_texttiling):
        self.max_chars_len = int(max_chars_len)
        self.use_texttiling = use_texttiling
        if use_texttiling:
            self.tt = TextTilingTokenizer()
        
    def chunk_para(self, para_text, save_path):
        chunks = []
        chunk_idx = 0
        for para_idx in para_text['paragraphs']:
            text = para_idx['text']
            if self.use_texttiling:
                try:
                    tiles = self.tt.tokenize(text)
                    for idx, tile in enumerate(tiles, 1):
                        chunks.append({
                            'para_id': para_idx['para_id'],
                            'chunk_index': chunk_idx,
                            'chunk_text': tile.strip()
                        })
                    return chunks
                except ValueError:
                    pass  
            parts = re.split(r'(?<=[。！？\.!\?])\s*', text)
            sentences = [p.strip() for p in parts if p.strip()]
            curr = ""
            for s in sentences:
                if len(curr) + len(s) + 1 > self.max_chars_len:
                    chunk_idx += 1
                    chunks.append({'para_id': para_idx['para_id'], 'chunk_index': chunk_idx, 'chunk_text': curr})
                    
                    curr = s
                else:
                    curr = (curr + " " + s).strip()
            if curr:
                chunk_idx += 1
                chunks.append({'para_id': para_idx['para_id'], 'chunk_index': chunk_idx, 'chunk_text': curr})
                # print(chunks)
        os.makedirs(os.path.dirname(save_path), exist_ok=True)
        with open(save_path, "w", encoding="utf-8") as f:
            json.dump(chunks, f, ensure_ascii=False, indent=2)

        print(f"\t[OK] Saved {len(chunks)} chunks to: {save_path}.")
        return chunks


# if __name__ == "__main__":
# #     loader = DataLoader()
# #     cleaner = TextCleaner()
# #     #seg = Segmenter()#不用了不用了！
#     chunker = Chunker()
# #     sample_path = "/Users/chenjo/Desktop/UNSW/2025/9900/AI_Moule/data/raw/z111.docx"

# #     if os.path.exists(sample_path):
# #         record = loader.metadata_extraction(sample_path)
# #         text_original = loader.load_file(sample_path)
# #         text_cleaned = cleaner.process(text_original)
        
#     text_cleaned = {'full_text': 'Snowy 2.0 Pumped Hydro Project — Group A Submission Executive summary Snowy 2.0 is a major pumped hydro expansion intended to increase the Snowy Scheme’s ability to store and deliver long duration energy to support a decarbonising electricity system. This report examines four principal issues that have affected the project during planning and early construction, these are: cost escalation, geotechnical complexity, supply chain constraints, and stakeholder engagement and social licence risks. The analysis takes a systems view, emphasising root causes rather than symptoms, and shows how technical, contractual and governance choices have interacted to amplify impacts. Key findings indicate that optimistic early cost estimates, incomplete geotechnical investigation at tender stage, narrow procurement windows for long lead items, and fragmented stakeholder engagement practices combined to create cascading schedule and cost pressures. Drawing on international mega-project literature and sector best practice, the report recommends a set of pragmatic actions to increase delivery resilience, including enhanced front end investigations, adaptive risk allocation through staged procurement, strengthened independent oversight, dedicated Indigenous and community liaison offices, and contingency governance that links cost, schedule and technical monitoring. The recommendations are intended to be implementable in the near term, and to inform future large infrastructure projects in Australia.\n\nIntroduction: Australia is undergoing rapid change in its electricity generation mix. High penetration of wind and solar is increasing the need for long duration storage to maintain reliability. Snowy 2.0 is positioned as a national priority project, providing pumped hydro storage that can absorb excess renewable output and deliver sustained generation when required. Given its scale and strategic importance, careful study of Snowy 2.0’s delivery challenges offers useful lessons for infrastructure planning and risk governance. This report provides a critical analysis of the Snowy 2.0 project from a project management perspective. It identifies the dominant delivery challenges, investigates root causes, explores linkages between problems, and assesses mitigation efforts against best practice. The intention is not to offer a complete forensic audit, but to produce a robust academic-style submission suitable for CVEN9723 assessment, that integrates technical, managerial and social dimensions. The structure of the report is as follows. Section 2 sets out project background and context. Section 3 identifies and describes the main challenges. Section 4 provides root cause analysis. Section 5 explores interdependencies and compounding effects. Section 6 summarises relevant literature and best practice. Section 7 offers critical reflection. Section 8 lists recommendations. The report ends with a brief conclusion and a reference list of plausible, but fictional, academic and industry style sources. Project background and context Snowy 2.0 is an expansion of the historical Snowy Mountains Hydroelectric Scheme, intended to provide approximately 2,000 MW of generation capacity and a large store of energy in pumped hydro form. The work involves construction of underground power stations, headrace and tailrace tunnels, extensive excavation and tunnelling in highly variable geology, and associated surface infrastructure such as transmission connections and access works. The project draws together multiple stakeholders, including Snowy Hydro Ltd as the proponent, federal and state governments as funders and regulators, major contractors for tunnelling and civils, specialist suppliers for electromechanical equipment, and local communities including Indigenous groups. The delivery model combined direct government involvement in project initiation with contracts awarded to private sector delivery teams. Project governance involved multiple government layers, a commercial proponent, and separate contracting streams for tunnelling, civils, and electro-mechanical works. The site environment is technically challenging, with complex geology, potential groundwater inflows, and constrained access in alpine terrain, which increases both technical and logistical risk. Given the project’s scale, international best practice suggests that successful delivery requires comprehensive front end loading, robust geotechnical investigations, clarity in risk allocation, and active stakeholder management. The challenges encountered to date reflect weaknesses in several of these domains, which are analysed in the subsequent sections. Identification of key challenges This section identifies the four principal challenges that have had the most significant impact on Snowy 2.0, each described with evidence-informed detail and practical implications. Cost escalation The project has experienced significant increases in estimated total cost compared to the initial budgets set at project inception. Cost escalation has been driven by factors including re-estimation following more detailed site investigations, claims and variations associated with unexpected ground conditions, and increases in contractor pricing driven by market conditions. The practical implications of cost escalation include pressure on public finances, renegotiation of project scopes, and delays in awarding subsequent contract packages. Geotechnical complexity and uncertainty Snowy 2.0 requires extensive tunnelling and underground excavation through highly variable rock masses. Early site investigations provided a degree of geological characterisation, however subsequent tunnelling encountered unexpected ground conditions in certain sections, including fractured zones and variable groundwater regimes. These conditions have increased excavation difficulty, required additional ground support systems, and triggered design adjustments. Geotechnical uncertainty also contributed to schedule volatility as tunnelling rates slowed where adverse conditions were encountered. Supply chain constraints and long lead items The project relies on specialized equipment and materials, many of which have long procurement lead times, for example turbine generators, large valves, and bespoke lining systems. Global supply chain pressures, constrained manufacturing capacity for specialised hydro equipment, and logistic challenges for transporting large items into a constrained alpine environment have added risk. Contractual timing that underestimated lead times increased the likelihood of delayed delivery of critical path items. Stakeholder engagement and social licence risks Snowy 2.0 intersects sensitive environmental and cultural landscapes, which creates heightened expectations for robust stakeholder engagement. Key stakeholder groups include local communities, businesses, environmental groups, and Indigenous Traditional Owners. In practice, tensions have emerged over impacts on local amenity, access, and cultural heritage. Perceived inadequacies in consultation and compensation mechanisms have eroded trust in some parts of the community, increasing reputational risk and the potential for delays from legal or political interventions. Root cause analysis This section investigates the underlying causes of the challenges outlined above. The analysis is deliberately systemic, considering technical, contractual and governance contributors. Causes of cost escalation\n\nA number of root causes underpin cost escalation: • Early optimism bias and insufficient contingency in initial cost estimates, which understate the magnitude of geological and logistical risk. • Fragmented procurement sequencing, where awarding separate packages without sufficient early verification of site conditions increases the exposure of contractors to unforeseen claims. • Market dynamics for construction and specialised equipment, such as limited availability of experienced tunnelling crews and manufacturing capacity for electromechanical components, which increase prices when demand spikes. • Weak integration between commercial teams and technical teams, producing estimation errors when technical risk is not fully monetised. These causes are mutually reinforcing, for example optimistic estimates reduce perceived need for extensive site investigation, which increases the chance of encountering unknown conditions later, which in turn produces claims and variations. Causes of geotechnical uncertainty\n\nThe geotechnical causes include: • Insufficient density of pre-tender boreholes and geophysical surveys, especially in high risk alignment zones. • Overreliance on historical site data from adjacent works which may not be representative of actual conditions along the new alignment. • Time pressures in the pre-contract phase, pushing teams to proceed to procurement with incomplete subsurface characterisation. • Limited allowance for variability in rock mass behaviour and groundwater regimes within the contractual risk matrix. Insufficient ground information increases the probability that the chosen excavation and support methods will need mid-course adjustment, causing both cost and time impacts. Causes of supply chain constraints\n\nKey causal factors are: • Underestimation of manufacturing lead times for specialised hydro equipment during tendering. • Global concentration of suppliers for certain components, leading to limited alternative sourcing options. • Inadequate procurement strategies to secure long lead items early, often due to budgetary or contractual sequencing choices. • Logistical constraints for transporting large components to mountain sites, including limited road access and seasonal constraints. These factors combine to increase the chance of critical path delays when a long lead item is delivered late. Causes of stakeholder friction\n\nUnderlying stakeholder causes are: • Perceived inadequacy of early consultation with local and Indigenous stakeholders, producing mistrust. • Inconsistent communications and changing project timelines, which reduce predictability for affected businesses and residents. • Compensation frameworks that are viewed as ad hoc rather than systematic, prompting calls for fairer arrangements. • Complex regulatory processes across multiple government agencies that create procedural delays, confusing stakeholders and increasing frustration. Poor early stakeholder alignment makes later mitigation more costly, both financially and in terms of social licence. Interdependencies and compounding effects The four challenge areas described above are strongly interdependent. The most important interactions are described below. Geotechnical issues driving cost and schedule Unexpected ground conditions acting as a primary technical shock have a direct effect on excavation rates, the need for additional ground support, and the requirement for design changes. When geotechnical surprises occur, contractors submit claims for additional time and payment. These claims drive cost escalation, which in turn can reduce available contingency for other risks. Supply chain timing exacerbated by schedule slip Schedule delays caused by geotechnical issues can shift the timing of long lead procurement, meaning that items ordered to match an initial programme may either arrive too early, requiring secure storage, or too late relative to the adjusted critical path. Both outcomes are costly. Moreover, market conditions can change during a schedule slip, increasing prices for equipment if supply is tight. Cost pressures increasing adversarial contracting behaviour As costs escalate, the relationship between client and contractor can become adversarial if risk allocation is perceived as unfair. Adversarial behaviour increases the likelihood of disputes and delays, further compounding schedule and cost impacts, and harming stakeholder confidence. Stakeholder actions amplifying regulatory and programme risk Local stakeholder disputes, whether over compensation, heritage, or environmental concerns, can prompt regulatory reviews or political scrutiny, which cause further programme uncertainty. Programme uncertainty feeds back into contractor risk premiums and can also affect the willingness of suppliers to commit to delivery windows. The combined effect of these interdependencies is path dependency, where early technical or governance weaknesses set the project on a trajectory of escalating cost and delay unless actively arrested. Literature review and best practice insights This section summarises key themes from the infrastructure, project management and megaproject literature that are relevant to the issues identified, and outlines best practice approaches that have been successful in related contexts. Front end loading and due diligence Front end loading, also referred to as early stage planning and detailed site investigation, is widely accepted as a determinant of successful outcomes for large civil projects. Robust early geotechnical work, higher sample density for boreholes, and pilot tunnelling trials reduce the probability of encountering major surprises later. The literature emphasises that investment in early investigation often returns multiple-fold savings by reducing claims and design rework. For Snowy 2.0, enhanced front end geotechnical investigation would reduce the ambiguity faced by bidders and assist in firming realistic cost estimates. Adaptive procurement and staged contracting International experience in hydro and tunnelling projects shows benefits from staged procurement, where long lead items and high risk packages are procured with shared risk mechanisms, including two-stage tendering where technical verification precedes firm pricing. Staged contracting allows early identification of interface risks and alignment of procurement timing with verified site data. Contract forms that encourage collaboration, such as alliancing or target outturn cost with pain and gain sharing, are frequently cited as useful for complex undertakings. Integrated risk governance and independent oversight Best practice suggests creating a clear governance structure that aligns technical, commercial and stakeholder responsibilities, with independent oversight to provide objective validation of cost estimates and progress metrics. Independent review panels or project assurance units can moderate optimism bias and ensure accountability. Transparent reporting to key stakeholders also supports trust. Stakeholder engagement, Indigenous partnership and social licence Meaningful engagement is more than consultation, it involves early involvement of Indigenous Traditional Owners, negotiated cultural heritage management, and transparent compensation and business support schemes for affected communities. Successful projects embed dedicated liaison offices and business continuity support programmes, which reduce reputational risk and maintain local support. Supply chain resilience and secure early procurement Strategies to enhance supply chain resilience include early booking of capacity with key manufacturers, pre-qualification of secondary suppliers, modularisation to simplify logistics, and contingency logistics plans for seasonal access restrictions. These measures reduce the vulnerability of the critical path to single point supplier failures. The literature indicates that no single intervention is sufficient, rather an integrated package of measures is needed to address technical, contractual and social dimensions concurrently. Critical reflection on governance and delivery choices This section critically reflects on Snowy 2.0’s governance decisions and how alternative choices might have mitigated impacts. Assessment of initial governance and procurement strategy The early choice to proceed with multiple separate contracts for tunnelling, civils and electro-mechanical works made sense to harness specialist capabilities, however it also increased interface risk. In a complex underground project, interfaces between tunnelling contractors and mechanical delivery teams are crucial, and insufficient contractual mechanisms to manage those interfaces increased cost and delay exposure. An alternative might have been a more integrated package for critical interfaces or a formal alliancing arrangement for high risk works to align incentives. Timing and sufficiency of geotechnical investigation Although standard geotechnical investigations were performed, the density and distribution of boreholes in critical zones appears insufficient given the geological variability reported during tunnelling. Given the high cost of surprises in underground works, a stronger front end programme, including additional boreholes and targeted geophysical surveys, could have reduced uncertainty and produced more reliable tender pricing. Stakeholder strategy critique Stakeholder engagement appears to have been undertaken in a traditional project consultation model, which is often inadequate for projects intersecting complex cultural and environmental values. Embedding long term Indigenous partnership frameworks, creating formal local business support schemes, and establishing continuous two-way communication channels would have better sustained social licence and reduced reputational risks. Balance between speed and quality in delivery Political and funding pressures to progress the project quickly are understandable given national energy needs, but rapid procurement without resolving key technical uncertainties transferred significant risk to later phases. A more measured approach during the planning window would likely have produced greater overall value for money by reducing claims, rework and schedule risk.\n\nRecommendations: The following recommendations are pragmatic, actionable, and prioritised to address the most urgent structural weaknesses identified. Immediate actions, highest priority Undertake targeted additional geotechnical investigation in zones with the greatest variability, including more boreholes and advanced geophysical surveys, to firm up design assumptions and reduce uncertainty for contractors. Establish an independent project assurance panel with the mandate to review cost estimates, progress metrics and risk allocation, and to publish concise findings to improve external confidence. Create a dedicated Indigenous and community liaison office with authority to coordinate heritage management, business support, and transparent communications, including locally based staff to maintain continuous dialogue. Procurement and contractual reforms Adopt staged procurement for long lead equipment, with early purchase agreements for critical items and contractual provisions that recognise legitimate changes associated with verified ground conditions. For packages with high interface risk, consider alliancing or a form of collaborative contract that aligns cost, schedule and technical incentives between client and contractors. Require enhanced technical verification as a condition precedent to fixed price acceptance for high risk packages, enabling re-pricing where necessary on the basis of agreed verification outcomes. Supply chain and logistics improvements Secure manufacturing slots with primary and secondary suppliers for critical components, and develop modular component strategies to reduce transport complexity. Establish strategic on-site or near-site storage and maintenance facilities for early-delivered long lead items to avoid storage-related damage and logistical bottlenecks. Implement a supply chain risk register that is actively monitored, including alternative sourcing options and contingency logistics routes. Stakeholder and social licence measures Design a transparent compensation and business continuity framework for local businesses and residents, guided by clear eligibility rules and timely payments. Co-develop heritage management plans with Indigenous Traditional Owners, including capacity building and employment pathways for local people. Introduce regular public progress dashboards, summarising milestones, geological findings, and mitigation measures, to increase transparency and trust. Monitoring, evaluation and continuous improvement Implement integrated performance dashboards that link geological monitoring, cost tracking and schedule performance, with automated alerts for variance thresholds. Institutionalise periodic independent reviews at key gate points to reassess risk allocation and adjust procurement or technical strategies accordingly. Use lessons learned captured from each major package to inform subsequent package tender documents and risk allocation, creating an iterative improvement loop.\n\nConclusion: Snowy 2.0 is a strategically important piece of infrastructure that faces typical mega-project risks, heightened by its underground nature and the alpine environment. Cost escalation, geotechnical surprises, supply chain vulnerabilities and stakeholder tensions have combined to generate complex delivery challenges. The analysis in this report shows that many of these issues are not purely technical, they stem from early-stage choices about the depth of investigation, procurement sequencing, and stakeholder engagement. A coordinated response that combines enhanced front end investigation, adaptive procurement and contractual strategies, strengthened independent oversight, and sustained stakeholder partnership can materially reduce risk and improve delivery outcomes. The recommendations are practicable, and if implemented with urgency, will reduce further cost escalation and reinforce social licence for Snowy 2.0 and for future large scale infrastructure projects in Australia.\n\nReferences: Bird, A. and Turner, J., 2018, Managing Uncertainty in Underground Works, Journal of Tunnelling and Surface Works, 12(4), 231-248. Carter, L., 2020, Procurement Strategies for Large Infrastructure Projects, Infrastructure Policy Review, 7(2), 45-68. Fletcher, P. and Zhao, H., 2019, Geotechnical Investigation Best Practice, International Journal of Geotechnical Engineering, 15(1), 77-102. Hammond, R., 2017, Stakeholder Engagement in Major Projects, Public Infrastructure Review, 9(3), 99-118. Johnson, M., Lee, S. and Roberts, A., 2021, Supply Chain Resilience for Energy Infrastructure, Energy Systems Journal, 5(1), 12-34. Khan, S., 2016, Front End Loading, Risk and Value in Megaprojects, Project Management Today, 22(6), 150-168. Norton, D., 2019, Alliancing and Collaborative Contracting in Water Projects, Australian Construction Management, 11(2), 203-221. Olsen, G. and Patel, R., 2015, Independent Assurance in Public Infrastructure Delivery, Governance in Engineering, 3(4), 65-81. Reed, T., 2020, Community Compensation and Business Support Schemes, Social Licence Quarterly, 2(3), 44-63. Taylor, H., 2014, Tunnelling in Variable Rock Masses, Proceedings of the International Tunnelling Conference, 2014, pp. 210-222. White, K., 2018, Long Lead Item Procurement in Hydro Projects, Journal of Supply Chain in Construction, 6(4), 88-105.', 'paragraphs': [{'para_id': 1, 'text': "snowy 2.0 pumped hydro project - group a submission executive summary snowy 2.0 is a major pumped hydro expansion intended to increase the snowy scheme's ability to store and deliver long duration energy to support a decarbonising electricity system. this report examines four principal issues that have affected the project during planning and early construction, these are: cost escalation, geotechnical complexity, supply chain constraints, and stakeholder engagement and social licence risks. the analysis takes a systems view, emphasising root causes rather than symptoms, and shows how technical, contractual and governance choices have interacted to amplify impacts. key findings indicate that optimistic early cost estimates, incomplete geotechnical investigation at tender stage, narrow procurement windows for long lead items, and fragmented stakeholder engagement practices combined to create cascading schedule and cost pressures. drawing on international mega-project literature and sector best practice, the report recommends a set of pragmatic actions to increase delivery resilience, including enhanced front end investigations, adaptive risk allocation through staged procurement, strengthened independent oversight, dedicated indigenous and community liaison offices, and contingency governance that links cost, schedule and technical monitoring. the recommendations are intended to be implementable in the near term, and to inform future large infrastructure projects in australia."}, {'para_id': 2, 'text': "introduction: australia is undergoing rapid change in its electricity generation mix. high penetration of wind and solar is increasing the need for long duration storage to maintain reliability. snowy 2.0 is positioned as a national priority project, providing pumped hydro storage that can absorb excess renewable output and deliver sustained generation when required. given its scale and strategic importance, careful study of snowy 2.0's delivery challenges offers useful lessons for infrastructure planning and risk governance. this report provides a critical analysis of the snowy 2.0 project from a project management perspective. it identifies the dominant delivery challenges, investigates root causes, explores linkages between problems, and assesses mitigation efforts against best practice. the intention is not to offer a complete forensic audit, but to produce a robust academic-style submission suitable for cven9723 assessment, that integrates technical, managerial and social dimensions. the structure of the report is as follows. section 2 sets out project background and context. section 3 identifies and describes the main challenges. section 4 provides root cause analysis. section 5 explores interdependencies and compounding effects. section 6 summarises relevant literature and best practice. section 7 offers critical reflection. section 8 lists recommendations. the report ends with a brief conclusion and a reference list of plausible, but fictional, academic and industry style sources. project background and context snowy 2.0 is an expansion of the historical snowy mountains hydroelectric scheme, intended to provide approximately 2000 mw of generation capacity and a large store of energy in pumped hydro form. the work involves construction of underground power stations, headrace and tailrace tunnels, extensive excavation and tunnelling in highly variable geology, and associated surface infrastructure such as transmission connections and access works. the project draws together multiple stakeholders, including snowy hydro ltd as the proponent, federal and state governments as funders and regulators, major contractors for tunnelling and civils, specialist suppliers for electromechanical equipment, and local communities including indigenous groups. the delivery model combined direct government involvement in project initiation with contracts awarded to private sector delivery teams. project governance involved multiple government layers, a commercial proponent, and separate contracting streams for tunnelling, civils, and electro-mechanical works. the site environment is technically challenging, with complex geology, potential groundwater inflows, and constrained access in alpine terrain, which increases both technical and logistical risk. given the project's scale, international best practice suggests that successful delivery requires comprehensive front end loading, robust geotechnical investigations, clarity in risk allocation, and active stakeholder management. the challenges encountered to date reflect weaknesses in several of these domains, which are analysed in the subsequent sections. identification of key challenges this section identifies the four principal challenges that have had the most significant impact on snowy 2.0, each described with evidence-informed detail and practical implications. cost escalation the project has experienced significant increases in estimated total cost compared to the initial budgets set at project inception. cost escalation has been driven by factors including re-estimation following more detailed site investigations, claims and variations associated with unexpected ground conditions, and increases in contractor pricing driven by market conditions. the practical implications of cost escalation include pressure on public finances, renegotiation of project scopes, and delays in awarding subsequent contract packages. geotechnical complexity and uncertainty snowy 2.0 requires extensive tunnelling and underground excavation through highly variable rock masses. early site investigations provided a degree of geological characterisation, however subsequent tunnelling encountered unexpected ground conditions in certain sections, including fractured zones and variable groundwater regimes. these conditions have increased excavation difficulty, required additional ground support systems, and triggered design adjustments. geotechnical uncertainty also contributed to schedule volatility as tunnelling rates slowed where adverse conditions were encountered. supply chain constraints and long lead items the project relies on specialized equipment and materials, many of which have long procurement lead times, for example turbine generators, large valves, and bespoke lining systems. global supply chain pressures, constrained manufacturing capacity for specialised hydro equipment, and logistic challenges for transporting large items into a constrained alpine environment have added risk. contractual timing that underestimated lead times increased the likelihood of delayed delivery of critical path items. stakeholder engagement and social licence risks snowy 2.0 intersects sensitive environmental and cultural landscapes, which creates heightened expectations for robust stakeholder engagement. key stakeholder groups include local communities, businesses, environmental groups, and indigenous traditional owners. in practice, tensions have emerged over impacts on local amenity, access, and cultural heritage. perceived inadequacies in consultation and compensation mechanisms have eroded trust in some parts of the community, increasing reputational risk and the potential for delays from legal or political interventions. root cause analysis this section investigates the underlying causes of the challenges outlined above. the analysis is deliberately systemic, considering technical, contractual and governance contributors. causes of cost escalation"}, {'para_id': 3, 'text': 'a number of root causes underpin cost escalation: • early optimism bias and insufficient contingency in initial cost estimates, which understate the magnitude of geological and logistical risk. • fragmented procurement sequencing, where awarding separate packages without sufficient early verification of site conditions increases the exposure of contractors to unforeseen claims. • market dynamics for construction and specialised equipment, such as limited availability of experienced tunnelling crews and manufacturing capacity for electromechanical components, which increase prices when demand spikes. • weak integration between commercial teams and technical teams, producing estimation errors when technical risk is not fully monetised. these causes are mutually reinforcing, for example optimistic estimates reduce perceived need for extensive site investigation, which increases the chance of encountering unknown conditions later, which in turn produces claims and variations. causes of geotechnical uncertainty'}, {'para_id': 4, 'text': 'the geotechnical causes include: • insufficient density of pre-tender boreholes and geophysical surveys, especially in high risk alignment zones. • overreliance on historical site data from adjacent works which may not be representative of actual conditions along the new alignment. • time pressures in the pre-contract phase, pushing teams to proceed to procurement with incomplete subsurface characterisation. • limited allowance for variability in rock mass behaviour and groundwater regimes within the contractual risk matrix. insufficient ground information increases the probability that the chosen excavation and support methods will need mid-course adjustment, causing both cost and time impacts. causes of supply chain constraints'}, {'para_id': 5, 'text': 'key causal factors are: • underestimation of manufacturing lead times for specialised hydro equipment during tendering. • global concentration of suppliers for certain components, leading to limited alternative sourcing options. • inadequate procurement strategies to secure long lead items early, often due to budgetary or contractual sequencing choices. • logistical constraints for transporting large components to mountain sites, including limited road access and seasonal constraints. these factors combine to increase the chance of critical path delays when a long lead item is delivered late. causes of stakeholder friction'}, {'para_id': 6, 'text': "underlying stakeholder causes are: • perceived inadequacy of early consultation with local and indigenous stakeholders, producing mistrust. • inconsistent communications and changing project timelines, which reduce predictability for affected businesses and residents. • compensation frameworks that are viewed as ad hoc rather than systematic, prompting calls for fairer arrangements. • complex regulatory processes across multiple government agencies that create procedural delays, confusing stakeholders and increasing frustration. poor early stakeholder alignment makes later mitigation more costly, both financially and in terms of social licence. interdependencies and compounding effects the four challenge areas described above are strongly interdependent. the most important interactions are described below. geotechnical issues driving cost and schedule unexpected ground conditions acting as a primary technical shock have a direct effect on excavation rates, the need for additional ground support, and the requirement for design changes. when geotechnical surprises occur, contractors submit claims for additional time and payment. these claims drive cost escalation, which in turn can reduce available contingency for other risks. supply chain timing exacerbated by schedule slip schedule delays caused by geotechnical issues can shift the timing of long lead procurement, meaning that items ordered to match an initial programme may either arrive too early, requiring secure storage, or too late relative to the adjusted critical path. both outcomes are costly. moreover, market conditions can change during a schedule slip, increasing prices for equipment if supply is tight. cost pressures increasing adversarial contracting behaviour as costs escalate, the relationship between client and contractor can become adversarial if risk allocation is perceived as unfair. adversarial behaviour increases the likelihood of disputes and delays, further compounding schedule and cost impacts, and harming stakeholder confidence. stakeholder actions amplifying regulatory and programme risk local stakeholder disputes, whether over compensation, heritage, or environmental concerns, can prompt regulatory reviews or political scrutiny, which cause further programme uncertainty. programme uncertainty feeds back into contractor risk premiums and can also affect the willingness of suppliers to commit to delivery windows. the combined effect of these interdependencies is path dependency, where early technical or governance weaknesses set the project on a trajectory of escalating cost and delay unless actively arrested. literature review and best practice insights this section summarises key themes from the infrastructure, project management and megaproject literature that are relevant to the issues identified, and outlines best practice approaches that have been successful in related contexts. front end loading and due diligence front end loading, also referred to as early stage planning and detailed site investigation, is widely accepted as a determinant of successful outcomes for large civil projects. robust early geotechnical work, higher sample density for boreholes, and pilot tunnelling trials reduce the probability of encountering major surprises later. the literature emphasises that investment in early investigation often returns multiple-fold savings by reducing claims and design rework. for snowy 2.0, enhanced front end geotechnical investigation would reduce the ambiguity faced by bidders and assist in firming realistic cost estimates. adaptive procurement and staged contracting international experience in hydro and tunnelling projects shows benefits from staged procurement, where long lead items and high risk packages are procured with shared risk mechanisms, including two-stage tendering where technical verification precedes firm pricing. staged contracting allows early identification of interface risks and alignment of procurement timing with verified site data. contract forms that encourage collaboration, such as alliancing or target outturn cost with pain and gain sharing, are frequently cited as useful for complex undertakings. integrated risk governance and independent oversight best practice suggests creating a clear governance structure that aligns technical, commercial and stakeholder responsibilities, with independent oversight to provide objective validation of cost estimates and progress metrics. independent review panels or project assurance units can moderate optimism bias and ensure accountability. transparent reporting to key stakeholders also supports trust. stakeholder engagement, indigenous partnership and social licence meaningful engagement is more than consultation, it involves early involvement of indigenous traditional owners, negotiated cultural heritage management, and transparent compensation and business support schemes for affected communities. successful projects embed dedicated liaison offices and business continuity support programmes, which reduce reputational risk and maintain local support. supply chain resilience and secure early procurement strategies to enhance supply chain resilience include early booking of capacity with key manufacturers, pre-qualification of secondary suppliers, modularisation to simplify logistics, and contingency logistics plans for seasonal access restrictions. these measures reduce the vulnerability of the critical path to single point supplier failures. the literature indicates that no single intervention is sufficient, rather an integrated package of measures is needed to address technical, contractual and social dimensions concurrently. critical reflection on governance and delivery choices this section critically reflects on snowy 2.0's governance decisions and how alternative choices might have mitigated impacts. assessment of initial governance and procurement strategy the early choice to proceed with multiple separate contracts for tunnelling, civils and electro-mechanical works made sense to harness specialist capabilities, however it also increased interface risk. in a complex underground project, interfaces between tunnelling contractors and mechanical delivery teams are crucial, and insufficient contractual mechanisms to manage those interfaces increased cost and delay exposure. an alternative might have been a more integrated package for critical interfaces or a formal alliancing arrangement for high risk works to align incentives. timing and sufficiency of geotechnical investigation although standard geotechnical investigations were performed, the density and distribution of boreholes in critical zones appears insufficient given the geological variability reported during tunnelling. given the high cost of surprises in underground works, a stronger front end programme, including additional boreholes and targeted geophysical surveys, could have reduced uncertainty and produced more reliable tender pricing. stakeholder strategy critique stakeholder engagement appears to have been undertaken in a traditional project consultation model, which is often inadequate for projects intersecting complex cultural and environmental values. embedding long term indigenous partnership frameworks, creating formal local business support schemes, and establishing continuous two-way communication channels would have better sustained social licence and reduced reputational risks. balance between speed and quality in delivery political and funding pressures to progress the project quickly are understandable given national energy needs, but rapid procurement without resolving key technical uncertainties transferred significant risk to later phases. a more measured approach during the planning window would likely have produced greater overall value for money by reducing claims, rework and schedule risk."}, {'para_id': 7, 'text': 'recommendations: the following recommendations are pragmatic, actionable, and prioritised to address the most urgent structural weaknesses identified. immediate actions, highest priority undertake targeted additional geotechnical investigation in zones with the greatest variability, including more boreholes and advanced geophysical surveys, to firm up design assumptions and reduce uncertainty for contractors. establish an independent project assurance panel with the mandate to review cost estimates, progress metrics and risk allocation, and to publish concise findings to improve external confidence. create a dedicated indigenous and community liaison office with authority to coordinate heritage management, business support, and transparent communications, including locally based staff to maintain continuous dialogue. procurement and contractual reforms adopt staged procurement for long lead equipment, with early purchase agreements for critical items and contractual provisions that recognise legitimate changes associated with verified ground conditions. for packages with high interface risk, consider alliancing or a form of collaborative contract that aligns cost, schedule and technical incentives between client and contractors. require enhanced technical verification as a condition precedent to fixed price acceptance for high risk packages, enabling re-pricing where necessary on the basis of agreed verification outcomes. supply chain and logistics improvements secure manufacturing slots with primary and secondary suppliers for critical components, and develop modular component strategies to reduce transport complexity. establish strategic on-site or near-site storage and maintenance facilities for early-delivered long lead items to avoid storage-related damage and logistical bottlenecks. implement a supply chain risk register that is actively monitored, including alternative sourcing options and contingency logistics routes. stakeholder and social licence measures design a transparent compensation and business continuity framework for local businesses and residents, guided by clear eligibility rules and timely payments. co-develop heritage management plans with indigenous traditional owners, including capacity building and employment pathways for local people. introduce regular public progress dashboards, summarising milestones, geological findings, and mitigation measures, to increase transparency and trust. monitoring, evaluation and continuous improvement implement integrated performance dashboards that link geological monitoring, cost tracking and schedule performance, with automated alerts for variance thresholds. institutionalise periodic independent reviews at key gate points to reassess risk allocation and adjust procurement or technical strategies accordingly. use lessons learned captured from each major package to inform subsequent package tender documents and risk allocation, creating an iterative improvement loop.'}, {'para_id': 8, 'text': 'conclusion: snowy 2.0 is a strategically important piece of infrastructure that faces typical mega-project risks, heightened by its underground nature and the alpine environment. cost escalation, geotechnical surprises, supply chain vulnerabilities and stakeholder tensions have combined to generate complex delivery challenges. the analysis in this report shows that many of these issues are not purely technical, they stem from early-stage choices about the depth of investigation, procurement sequencing, and stakeholder engagement. a coordinated response that combines enhanced front end investigation, adaptive procurement and contractual strategies, strengthened independent oversight, and sustained stakeholder partnership can materially reduce risk and improve delivery outcomes. the recommendations are practicable, and if implemented with urgency, will reduce further cost escalation and reinforce social licence for snowy 2.0 and for future large scale infrastructure projects in australia.'}, {'para_id': 9, 'text': 'references: bird, a. and turner, j., 2018, managing uncertainty in underground works, journal of tunnelling and surface works, 12(4), 231-248. carter, l., 2020, procurement strategies for large infrastructure projects, infrastructure policy review, 7(2), 45-68. fletcher, p. and zhao, h., 2019, geotechnical investigation best practice, international journal of geotechnical engineering, 15(1), 77-102. hammond, r., 2017, stakeholder engagement in major projects, public infrastructure review, 9(3), 99-118. johnson, m., lee, s. and roberts, a., 2021, supply chain resilience for energy infrastructure, energy systems journal, 5(1), 12-34. khan, s., 2016, front end loading, risk and value in megaprojects, project management today, 22(6), 150-168. norton, d., 2019, alliancing and collaborative contracting in water projects, australian construction management, 11(2), 203-221. olsen, g. and patel, r., 2015, independent assurance in public infrastructure delivery, governance in engineering, 3(4), 65-81. reed, t., 2020, community compensation and business support schemes, social licence quarterly, 2(3), 44-63. taylor, h., 2014, tunnelling in variable rock masses, proceedings of the international tunnelling conference, 2014, pp. 210-222. white, k., 2018, long lead item procurement in hydro projects, journal of supply chain in construction, 6(4), 88-105.'}]}
# #         for idx in text_cleaned['paragraphs']:
#     chunker.chunk_para(text_cleaned)